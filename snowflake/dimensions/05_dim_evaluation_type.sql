-- =====================================================
-- DIM_EVALUATION_TYPE - Evaluation Type Dimension
-- =====================================================
-- Purpose: Types of medical evaluations
-- SCD Type: Type 1

USE SCHEMA VETERAN_EVALUATION_DW.DIM;

CREATE OR REPLACE TABLE DIM_EVALUATION_TYPE (
    EVALUATION_TYPE_KEY INTEGER AUTOINCREMENT PRIMARY KEY,
    EVALUATION_TYPE_ID VARCHAR(50) NOT NULL UNIQUE,  -- Business key

    -- Evaluation Type Information
    EVALUATION_TYPE_NAME VARCHAR(255) NOT NULL,
    EVALUATION_TYPE_DESCRIPTION TEXT,
    EVALUATION_CATEGORY VARCHAR(100),  -- C&P Exam, Independent Medical Exam, Disability Evaluation, etc.

    -- Evaluation Characteristics
    TYPICAL_DURATION_MINUTES INTEGER,
    REQUIRES_SPECIALIST BOOLEAN DEFAULT FALSE,
    SPECIALTY_REQUIRED VARCHAR(100),
    COMPLEXITY_LEVEL VARCHAR(20),  -- Low, Medium, High

    -- Regulatory Information
    REGULATORY_REQUIREMENT VARCHAR(255),
    CFR_REFERENCE VARCHAR(100),  -- Code of Federal Regulations reference
    VBA_REFERENCE VARCHAR(100),  -- Veterans Benefits Administration reference

    -- Scheduling
    ADVANCE_NOTICE_DAYS INTEGER DEFAULT 7,
    ALLOW_TELEHEALTH BOOLEAN DEFAULT FALSE,
    REQUIRES_FASTING BOOLEAN DEFAULT FALSE,
    REQUIRES_PREP BOOLEAN DEFAULT FALSE,
    PREP_INSTRUCTIONS TEXT,

    -- Status
    ACTIVE_FLAG BOOLEAN DEFAULT TRUE,
    DEPRECATED_DATE DATE,
    REPLACEMENT_EVALUATION_TYPE_ID VARCHAR(50),

    -- Metadata
    SOURCE_SYSTEM VARCHAR(50),
    CREATED_TIMESTAMP TIMESTAMP_NTZ DEFAULT CURRENT_TIMESTAMP(),
    UPDATED_TIMESTAMP TIMESTAMP_NTZ DEFAULT CURRENT_TIMESTAMP()
)
COMMENT = 'Type 1 dimension for evaluation types and categories';
